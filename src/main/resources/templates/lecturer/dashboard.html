<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/lecturer-layout :: head(title='Dashboard Pengajar')}">
    <title>Dashboard Pengajar - Dikoding Muda Nusantara</title>
</head>
<body>

<div class="dashboard-layout">
    <!-- Sidebar -->
    <aside th:replace="~{fragments/lecturer-layout :: sidebar(activeMenu='dashboard')}"></aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Top Header -->
        <header th:replace="~{fragments/lecturer-layout :: topHeader(pageTitle='Dashboard', showCreateButton=true)}"></header>

        <!-- Content Area -->
        <div class="content-area">
            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon blue">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                        </div>
                        <span class="stat-trend up" th:if="${coursesTrend != null and coursesTrend > 0}">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            +<span th:text="${coursesTrend}">2</span>
                        </span>
                    </div>
                    <div class="stat-value" th:text="${totalCourses != null} ? ${totalCourses} : 0">12</div>
                    <div class="stat-label">Total Kursus</div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon green">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                        </div>
                        <span class="stat-trend up" th:if="${studentsTrend != null and studentsTrend > 0}">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            +<span th:text="${studentsTrend}">156</span>
                        </span>
                    </div>
                    <div class="stat-value" th:text="${totalStudents != null} ? ${totalStudents} : 0">3,456</div>
                    <div class="stat-label">Total Pelajar</div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon yellow">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <span class="stat-trend up" th:if="${earningsTrend != null and earningsTrend > 0}">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            +<span th:text="${earningsTrend}">12</span>%
                        </span>
                    </div>
                    <div class="stat-value" th:text="${totalEarnings != null} ? 'Rp ' + ${#numbers.formatInteger(totalEarnings, 3, 'POINT')} : 'Rp 0'">Rp 12.500.000</div>
                    <div class="stat-label">Total Pendapatan</div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon red">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                            </svg>
                        </div>
                        <span class="stat-trend up" th:if="${ratingTrend != null and ratingTrend > 0}">
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                                <polyline points="17 6 23 6 23 12"></polyline>
                            </svg>
                            +<span th:text="${ratingTrend}">0.2</span>
                        </span>
                    </div>
                    <div class="stat-value" th:text="${averageRating != null} ? ${averageRating} : '-'">4.8</div>
                    <div class="stat-label">Rating Rata-rata</div>
                </div>
            </div>

            <!-- Dashboard Grid -->
            <div class="dashboard-grid">
                <!-- Left Column -->
                <div>
                    <!-- Earnings Chart -->
                    <div class="card mb-4">
                        <div class="card-header">
                            <h2 class="card-title">Pendapatan Bulanan</h2>
                            <a href="/lecturer/earnings" class="card-link">Lihat Detail</a>
                        </div>
                        <div class="card-body">
                            <div class="chart-placeholder" id="earningsChart">
                                Grafik Pendapatan
                            </div>
                        </div>
                    </div>

                    <!-- Recent Courses -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Kursus Saya</h2>
                            <a href="/lecturer/courses" class="card-link">Lihat Semua</a>
                        </div>
                        <div class="card-body">
                            <!-- Dynamic Course Items -->
                            <div th:if="${courses != null and !courses.isEmpty()}">
                                <div th:each="course : ${courses}" class="course-item">
                                    <div class="course-thumb">
                                        <img th:if="${course.thumbnailUrl != null}" 
                                             th:src="@{/files/view(path=${course.thumbnailUrl})}" 
                                             th:alt="${course.title}">
                                        <span th:if="${course.thumbnailUrl == null}">Thumb</span>
                                    </div>
                                    <div class="course-info">
                                        <h3 class="course-title" th:text="${course.title}">Judul Kursus</h3>
                                        <div class="course-meta">
                                            <span th:text="${course.students != null ? course.students : 0} + ' pelajar'">0 pelajar</span>
                                            <span th:text="${course.rating != null ? course.rating : '-'} + ' rating'">- rating</span>
                                        </div>
                                    </div>
                                    <span th:class="'course-status status-' + ${course.status.name().toLowerCase()}" 
                                          th:text="${course.status}">Published</span>
                                </div>
                            </div>

                            <!-- Empty State -->
                            <div th:if="${courses == null or courses.isEmpty()}" class="text-center py-4">
                                <p class="text-muted mb-3">Belum ada kursus</p>
                                <a href="/lecturer/courses/create" class="btn btn-primary-custom">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 5v14"></path>
                                        <path d="M5 12h14"></path>
                                    </svg>
                                    Buat Kursus Pertama
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div>
                    <!-- Recent Activity -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Aktivitas Terbaru</h2>
                        </div>
                        <div class="card-body">
                            <!-- Dynamic Activity Items -->
                            <div th:if="${activities != null and !activities.isEmpty()}">
                                <div th:each="activity : ${activities}" class="activity-item">
                                    <div th:class="'activity-icon ' + ${activity.type}">
                                        <svg th:if="${activity.type == 'sale'}" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="1" x2="12" y2="23"></line>
                                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                        </svg>
                                        <svg th:if="${activity.type == 'review'}" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                        </svg>
                                        <svg th:if="${activity.type == 'enroll'}" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="8.5" cy="7" r="4"></circle>
                                            <line x1="20" y1="8" x2="20" y2="14"></line>
                                            <line x1="23" y1="11" x2="17" y2="11"></line>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-text" th:utext="${activity.text}">Aktivitas</div>
                                        <div class="activity-time" th:text="${activity.time}">5 menit yang lalu</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Sample Activities (remove when using real data) -->
                            <div th:if="${activities == null or activities.isEmpty()}">
                                <div class="activity-item">
                                    <div class="activity-icon sale">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="1" x2="12" y2="23"></line>
                                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-text"><strong>Ahmad Rizky</strong> membeli kursus JavaScript</div>
                                        <div class="activity-time">5 menit yang lalu</div>
                                    </div>
                                </div>

                                <div class="activity-item">
                                    <div class="activity-icon review">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-text"><strong>Siti Nurhaliza</strong> memberi rating 5 bintang</div>
                                        <div class="activity-time">1 jam yang lalu</div>
                                    </div>
                                </div>

                                <div class="activity-item">
                                    <div class="activity-icon enroll">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                            <circle cx="8.5" cy="7" r="4"></circle>
                                            <line x1="20" y1="8" x2="20" y2="14"></line>
                                            <line x1="23" y1="11" x2="17" y2="11"></line>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-text"><strong>12 pelajar baru</strong> bergabung hari ini</div>
                                        <div class="activity-time">3 jam yang lalu</div>
                                    </div>
                                </div>

                                <div class="activity-item">
                                    <div class="activity-icon sale">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <line x1="12" y1="1" x2="12" y2="23"></line>
                                            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-text"><strong>Dewi Anggraini</strong> membeli kursus React.js</div>
                                        <div class="activity-time">5 jam yang lalu</div>
                                    </div>
                                </div>

                                <div class="activity-item">
                                    <div class="activity-icon review">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                                        </svg>
                                    </div>
                                    <div class="activity-content">
                                        <div class="activity-text"><strong>Budi Hartono</strong> menambahkan ulasan baru</div>
                                        <div class="activity-time">Kemarin</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- Scripts -->
<th:block th:replace="~{fragments/lecturer-layout :: scripts}"></th:block>

</body>
</html>